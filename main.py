# Code Optimizations:

1. Import only necessary functions and modules from the libraries to reduce memory consumption and improve performance.
2. Use list comprehension instead of for loops for faster iteration.
3. Use numpy vectorized functions for calculations instead of lambda functions.
4. Use inplace operations and method chaining to avoid creating unnecessary intermediate dataframes.
5. Split long code lines for better readability and maintainability.
6. Use constant variables for API endpoints, error messages, and magic numbers to make the code more flexible and maintainable.
7. Use try -except blocks for error handling and provide meaningful error messages.
8. Use .iloc for integer indexing instead of .loc for better performance.

Let's begin with the optimizations:
